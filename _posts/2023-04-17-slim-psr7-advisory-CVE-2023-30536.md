---
title: "Security Advisory: Improper header validation in Slim-Psr7"
description: Improper header validation in Slim-Psr7 security advisory released for v1.6.0 and below. This advisory has been assigned CVE-2023-30536. Please upgrade to 1.6.1 to resolve this issue.
layout: post
---

A security issue has recently been reported in Slim-Psr7 with the handling of new lines in headers.  

## Impact

An attacker could sneak in a newline (\n) into both the header names and values. While the specification states that \r\n\r\n is used to terminate the header list, many servers in the wild will also accept \n\n. An attacker that is able to control the header names that are passed to Slilm-Psr7 would be able to intentionally craft invalid messages, possibly causing application errors or invalid HTTP requests being sent out with an PSR-18 HTTP client. The latter might present a denial of service vector if a remote serviceâ€™s web application firewall bans the application due to the receipt of malformed requests.

## Affected versions

All versions less than 1.6.1.

## Patches

The issue is patched in version 1.6.1.

## Workarounds

In Slim-Psr7 1.6.0 and below, validate HTTP header keys and/or values, and if using user-supplied values, filter them to strip off leading or trailing newline characters before calling withHeader().

For example:

    $request = $request->withHeader(trim($headerName), trim($headerValue));

## Acknowledgments

We are very grateful to and thank <a href="https://gjcampbell.co.uk/">Graham Campbell</a> for reporting this issue, providing a patch and working with us on this issue.

## Further information

* <a href="https://github.com/slimphp/Slim-Psr7/security/advisories/GHSA-q2qj-628g-vhfw">Slim-Psr7 advisory on GitHub</a>
